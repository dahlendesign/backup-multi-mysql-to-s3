FROM alpine:latest
MAINTAINER Johannes Dahl√©n "johannes@dahlendesign.se"

ADD install.sh install.sh
RUN sh install.sh && rm install.sh

ENV NUMBER_OF_JOBS 1

ENV MYSQLDUMP_OPTIONS_GLOBAL --quote-names --quick --add-drop-table --add-locks --allow-keywords --disable-keys --extended-insert --single-transaction --create-options --comments --net_buffer_length=16384
ENV MYSQLDUMP_DATABASE_GLOBAL --all-databases
ENV MYSQL_HOST_GLOBAL **None**
ENV MYSQL_PORT_GLOBAL 3306
ENV MYSQL_USER_GLOBAL **None**
ENV MYSQL_PASSWORD_GLOBAL **None**
ENV S3_ACCESS_KEY_ID_GLOBAL **None**
ENV S3_SECRET_ACCESS_KEY_GLOBAL **None**
ENV S3_BUCKET_GLOBAL **None**
ENV S3_REGION_GLOBAL eu-central-1
ENV S3_ENDPOINT_GLOBAL https://s3.eu-central-1.amazonaws.com
ENV S3_S3V4_GLOBAL yes
ENV S3_PREFIX_GLOBAL 'backup'
ENV S3_VERSIONING_GLOBAL yes
ENV MULTI_FILES_GLOBAL no
ENV SCHEDULE_GLOBAL **None**

ENV MYSQLDUMP_OPTIONS_1 **None**
ENV MYSQLDUMP_DATABASE_1 **None**
ENV MYSQL_HOST_1 **None**
ENV MYSQL_PORT_1 **None**
ENV MYSQL_USER_1 **None**
ENV MYSQL_PASSWORD_1 **None**
ENV S3_ACCESS_KEY_ID_1 **None**
ENV S3_SECRET_ACCESS_KEY_1 **None**
ENV S3_BUCKET_1 **None**
ENV S3_REGION_1 **None**
ENV S3_ENDPOINT_1 **None**
ENV S3_S3V4_1 **None**
ENV S3_PREFIX_1 **None**
ENV S3_VERSIONING_1 **None**
ENV MULTI_FILES_1 **None**
ENV SCHEDULE_1 **None**

ENV MYSQLDUMP_OPTIONS_2 **None**
ENV MYSQLDUMP_DATABASE_2 **None**
ENV MYSQL_HOST_2 **None**
ENV MYSQL_PORT_2 **None**
ENV MYSQL_USER_2 **None**
ENV MYSQL_PASSWORD_2 **None**
ENV S3_ACCESS_KEY_ID_2 **None**
ENV S3_SECRET_ACCESS_KEY_2 **None**
ENV S3_BUCKET_2 **None**
ENV S3_REGION_2 **None**
ENV S3_ENDPOINT_2 **None**
ENV S3_S3V4_2 **None**
ENV S3_PREFIX_2 **None**
ENV S3_VERSIONING_2 **None**
ENV MULTI_FILES_2 **None**
ENV SCHEDULE_2 **None**

ENV MYSQLDUMP_OPTIONS_3 **None**
ENV MYSQLDUMP_DATABASE_3 **None**
ENV MYSQL_HOST_3 **None**
ENV MYSQL_PORT_3 **None**
ENV MYSQL_USER_3 **None**
ENV MYSQL_PASSWORD_3 **None**
ENV S3_ACCESS_KEY_ID_3 **None**
ENV S3_SECRET_ACCESS_KEY_3 **None**
ENV S3_BUCKET_3 **None**
ENV S3_REGION_3 **None**
ENV S3_ENDPOINT_3 **None**
ENV S3_S3V4_3 **None**
ENV S3_PREFIX_3 **None**
ENV S3_VERSIONING_3 **None**
ENV MULTI_FILES_3 **None**
ENV SCHEDULE_3 **None**

ENV MYSQLDUMP_OPTIONS_4 **None**
ENV MYSQLDUMP_DATABASE_4 **None**
ENV MYSQL_HOST_4 **None**
ENV MYSQL_PORT_4 **None**
ENV MYSQL_USER_4 **None**
ENV MYSQL_PASSWORD_4 **None**
ENV S3_ACCESS_KEY_ID_4 **None**
ENV S3_SECRET_ACCESS_KEY_4 **None**
ENV S3_BUCKET_4 **None**
ENV S3_REGION_4 **None**
ENV S3_ENDPOINT_4 **None**
ENV S3_S3V4_4 **None**
ENV S3_PREFIX_4 **None**
ENV S3_VERSIONING_4 **None**
ENV MULTI_FILES_4 **None**
ENV SCHEDULE_4 **None**

ENV MYSQLDUMP_OPTIONS_5 **None**
ENV MYSQLDUMP_DATABASE_5 **None**
ENV MYSQL_HOST_5 **None**
ENV MYSQL_PORT_5 **None**
ENV MYSQL_USER_5 **None**
ENV MYSQL_PASSWORD_5 **None**
ENV S3_ACCESS_KEY_ID_5 **None**
ENV S3_SECRET_ACCESS_KEY_5 **None**
ENV S3_BUCKET_5 **None**
ENV S3_REGION_5 **None**
ENV S3_ENDPOINT_5 **None**
ENV S3_S3V4_5 **None**
ENV S3_PREFIX_5 **None**
ENV S3_VERSIONING_5 **None**
ENV MULTI_FILES_5 **None**
ENV SCHEDULE_5 **None**

ENV MYSQLDUMP_OPTIONS_6 **None**
ENV MYSQLDUMP_DATABASE_6 **None**
ENV MYSQL_HOST_6 **None**
ENV MYSQL_PORT_6 **None**
ENV MYSQL_USER_6 **None**
ENV MYSQL_PASSWORD_6 **None**
ENV S3_ACCESS_KEY_ID_6 **None**
ENV S3_SECRET_ACCESS_KEY_6 **None**
ENV S3_BUCKET_6 **None**
ENV S3_REGION_6 **None**
ENV S3_ENDPOINT_6 **None**
ENV S3_S3V4_6 **None**
ENV S3_PREFIX_6 **None**
ENV S3_VERSIONING_6 **None**
ENV MULTI_FILES_6 **None**
ENV SCHEDULE_6 **None**

ENV MYSQLDUMP_OPTIONS_7 **None**
ENV MYSQLDUMP_DATABASE_7 **None**
ENV MYSQL_HOST_7 **None**
ENV MYSQL_PORT_7 **None**
ENV MYSQL_USER_7 **None**
ENV MYSQL_PASSWORD_7 **None**
ENV S3_ACCESS_KEY_ID_7 **None**
ENV S3_SECRET_ACCESS_KEY_7 **None**
ENV S3_BUCKET_7 **None**
ENV S3_REGION_7 **None**
ENV S3_ENDPOINT_7 **None**
ENV S3_S3V4_7 **None**
ENV S3_PREFIX_7 **None**
ENV S3_VERSIONING_7 **None**
ENV MULTI_FILES_7 **None**
ENV SCHEDULE_7 **None**

ENV MYSQLDUMP_OPTIONS_8 **None**
ENV MYSQLDUMP_DATABASE_8 **None**
ENV MYSQL_HOST_8 **None**
ENV MYSQL_PORT_8 **None**
ENV MYSQL_USER_8 **None**
ENV MYSQL_PASSWORD_8 **None**
ENV S3_ACCESS_KEY_ID_8 **None**
ENV S3_SECRET_ACCESS_KEY_8 **None**
ENV S3_BUCKET_8 **None**
ENV S3_REGION_8 **None**
ENV S3_ENDPOINT_8 **None**
ENV S3_S3V4_8 **None**
ENV S3_PREFIX_8 **None**
ENV S3_VERSIONING_8 **None**
ENV MULTI_FILES_8 **None**
ENV SCHEDULE_8 **None**

ENV MYSQLDUMP_OPTIONS_9 **None**
ENV MYSQLDUMP_DATABASE_9 **None**
ENV MYSQL_HOST_9 **None**
ENV MYSQL_PORT_9 **None**
ENV MYSQL_USER_9 **None**
ENV MYSQL_PASSWORD_9 **None**
ENV S3_ACCESS_KEY_ID_9 **None**
ENV S3_SECRET_ACCESS_KEY_9 **None**
ENV S3_BUCKET_9 **None**
ENV S3_REGION_9 **None**
ENV S3_ENDPOINT_9 **None**
ENV S3_S3V4_9 **None**
ENV S3_PREFIX_9 **None**
ENV S3_VERSIONING_9 **None**
ENV MULTI_FILES_9 **None**
ENV SCHEDULE_9 **None**

ENV MYSQLDUMP_OPTIONS_10 **None**
ENV MYSQLDUMP_DATABASE_10 **None**
ENV MYSQL_HOST_10 **None**
ENV MYSQL_PORT_10 **None**
ENV MYSQL_USER_10 **None**
ENV MYSQL_PASSWORD_10 **None**
ENV S3_ACCESS_KEY_ID_10 **None**
ENV S3_SECRET_ACCESS_KEY_10 **None**
ENV S3_BUCKET_10 **None**
ENV S3_REGION_10 **None**
ENV S3_ENDPOINT_10 **None**
ENV S3_S3V4_10 **None**
ENV S3_PREFIX_10 **None**
ENV S3_VERSIONING_10 **None**
ENV MULTI_FILES_10 **None**
ENV SCHEDULE_10 **None**

ADD run.sh run.sh
ADD backup.sh backup.sh

CMD ["/bin/sh", "/run.sh"]